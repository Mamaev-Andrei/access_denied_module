<?php
/**
*This module blocked pages if user select language, what's not exists 
*/



function access_denied_form_node_form_alter(&$form, & $form_state) {
  $valang = array();
  $value = array(); 
  $lang = array();
  $languages = language_list('enabled');    
  foreach($languages as $key => $value) {
    $valang[] = $value;
    foreach($value as $k => $val) {
      $lang[] = $val->name;    
  }
    }
    dsm ($lang);
  $form['addmenu'] = array (
    '#description'    => t('In this field you may blocked content for user on this languages'),
    '#type'           => 'fieldset',
    '#title'          => 'Blocked node for this language',
    '#group'          => 'additional_settings',
    '#weight'         => -99,
  );
  $form['addmenu']['addlanguage'] = array (  
    '#type'      => 'checkboxes',
    '#title'    => t('For what language access denied?'),
    '#options' => $lang,
  );
}

function access_denied_node_submit($node, $form, &$form_state)  {
  if ($node->type === 'article') :
  if ($form_state['values']['addlanguage']):
    $query = db_insert('tablang')
    ->fields(array(
      'checkbox' => ($form_state['values']['addlanguage']),
      'name' => $lang,
    ))
    ->execute();
    drupal_set_message('Заблокированы Ноды для страницы <em class="placeholder">'. $node->title. '</em>.');
  endif;
  endif;
  dsm ($form_state['values']['addlanguage']);
}  


  

  
    




 




